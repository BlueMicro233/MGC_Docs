# 视频设置和相关显示问题

> 已订正的文档
> 这篇文档在最近进行过订正，可以放心阅读。  
{style="tip"}

这篇文章列出了整个视频设置选项卡中容易出现问题的设置以及修改建议。

图像品质
: 这个选项是统一设置，它影响 `细节` 选项卡中所有设置为 `默认` 的图形品质，但当它们更改时，会覆盖掉 `图像品质` 的选项。
> 确保此选项为 `高品质` 。

    > *`极佳！`* 与 OptiFine 光影不兼容。
    {style="warning"}

亮度
: 设置为一个正常的值。不要用模组或手动编辑 `options.txt` 将其设置为一个极端的值。
> 大多数光影并不受这个值的影响。

最大帧率
: 大多数现代光影都使用了时间性效果，如 TAA。帧率锁在过低的值上可能导致拖影。
> 设置为 `无限制` 以保证最佳画质

    > 如果你的帧率低于显示器刷新率，那么可以尝试调整为 `垂直同步` 。
    > - 未启用垂直同步：
    > ```plantuml
    > @startuml
    > analog "显示纵场" as Mo
    > concise "GPU（每帧）" as GPU
    > scale 1000 as 100 pixels
    > 
    > @Mo
    > 999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +1000 is 0
    > Mo@1000 <-> @1999 : 显示提交的上一帧
    > 
    > @GPU
    > 0 is A
    > +1000 is B
    > +1000 is C
    > +600 is D
    > +1400 is E
    > +1300 is 终止
    > GPU@2000 <-> @2600 : 过早完成绘制
    > GPU@4000 <-> @5300 : 过晚完成绘制
    > 
    > @1000
    > GPU -> Mo : 向显示器提交画面
    > 
    > @3000
    > GPU -> Mo : 正在绘制的 D 帧\n覆盖了先前 C 帧\n的部分内容\n导致显示画面的上部\n有一部分为 D 帧的内容
    > 
    > @5000
    > GPU -> Mo : E 帧此时还未绘制完成\n但是在显示器纵场\n到达之前完成绘制\n不会出现问题
    > 
    > @enduml
    > ```
    > - 启用垂直同步：
    > ```plantuml
    > @startuml
    > analog "显示纵场" as Mo
    > concise "GPU（每帧）" as GPU
    > scale 1000 as 100 pixels
    > 
    > @Mo
    > 999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +999 is 0
    > +1 is 1080
    > +1000 is 0
    > Mo@1000 <-> @1999 : 显示提交的上一帧
    > 
    > @GPU
    > 0 is A
    > +1000 is B
    > +1000 is C
    > +600 is 等待
    > +400 is D
    > +1000 is E
    > +1300 is 等待
    > +700 is 终止
    > GPU@2600 <-> @3000 : GPU 停止绘制，等待显示器显示
    > GPU@4000 <-> @6000 : GPU 额外等待一个周期绘制下一帧
    > 
    > @1000
    > GPU -> Mo : 向显示器提交画面
    > 
    > @2600
    > GPU -> Mo : C 帧绘制完成后等待提交\n直到 C 帧提交之后才会开始绘制 D 帧
    > 
    > @5000
    > GPU -> Mo : E 帧此时还未绘制完成\n显示器将会重复显示 D 帧\n直到 E 帧绘制完毕\n导致了 1 帧的滞后
    > 
    > @5999
    > GPU -> Mo : GPU 提交 E 帧
    > 
    > @enduml
    > ```
    > **注意**：这可能导致画面显示滞后
    {style="note"}

## 子选项卡

<tabs group="videoSettings">
<tab title="品质" group-key="quality">

Mipmap 级别
: 有时会在 *JE 1.19* 以上的 OptiFine 中破坏光影包。
- 比如所有方块的面都被从对角线切割成了两个三角形，并且有一半的三角形被对角线的平行线填充，或者方块边缘出现细线。  
- MipMap 还会破坏一些光影的自发光渲染。一旦光影支持自发光，视差所有凹下去的地方边缘都会异常发光。
> 如果你遇到了这些问题，请把它拉至 `关` 。
>
![贴图显示错误](mipmap.png "问题截图1 - 贴图显示错误")
![方块边缘的横线](line.png "问题截图2 - 方块边缘的横线")

各向异性过滤
: 有时会破坏使用虚化的光影包。
> 如果你看见*天空有奇怪的线条或撕裂*，请把其设置为 `关` 。
>
![云层被撕裂](cloud.png "云层被撕裂")
> 同时注意将显卡驱动控制面板的该选项设置为 `应用程序控制的` 。  
> ![在 Nvidia 控制面板中切换各向异性过滤设置](nvidia_af_by_programs.png "在 Nvidia 控制面板中切换各向异性过滤设置")  
> 或者直接将全局设置改为 `由 3D 应用程序决定` 。  
> ![在 Nvidia 控制面板中更改图像设置](nvidia_all_by_programs.png "在 Nvidia 控制面板中更改图像设置")
{style="note"}

连接纹理
: 当资源包兼容时会让相邻方块产生相互关联的纹理，可能会破坏视差。
> 一些资源包要求启用该选项（如 Patrix）。

自然纹理
: 它会随机旋转某些方块的表面纹理，可能会破坏一些老光影上的视差。
> 如果你有这方面的问题，请将其 `关` 。

自定义天空
: 使用 OptiFine 自定义天空的资源包与大多数修改了天空的光影不兼容。
> 在使用光影时，请将其设置为 `关` 。

</tab>
<tab title="细节" group-key="detail">

云
: 原版云总是不能与光影包兼容，特别是在旧版本中。
> - 如果你看到疑似原版云在天空表现违和，请将其设置为 `关` 。
> - 你也可以在你所使用光影的 `shaders.properties` 文件中加入
>   ```Ini
>   clouds = off
>   ```
>   来强制禁用特定光影的原版云
>
![原版云在光影中被不正确地渲染](cloud-vanilla.png "原版云在光影中被不正确地渲染")


树
: 不要将其设置为 `流畅` ，**这会导致树叶的透明度被禁用，从而无法正常裁切**。这对使用自定义模型的资源包影响尤为严重。
> `智能` 模式只显示最外面一层的树叶（就像玻璃一样），这会在有些时候导致树非常难看。
> 
![树叶的裁切被禁用](leaves.png "树叶的裁切被禁用")

天空
: 有修改了天空效果的光影通常不受该选项的影响。
> 推荐为 `开` 。

替选方块
: 这有时会破坏视差。有时会使贴图产生**拉伸的奇怪效果**，同时左上角报代号 `1281` 的 OpenGL 渲染错误。
> - 如果你有这方面的问题，请将其设置为 `关` 。
> - 在一些带有 CTM 贴图（连接纹理贴图）的资源包中，此选项**必须打开**以获得最佳效果。
>
![图片](draw.png)  
**问题截图 - 方块表面纹理在经过视差之后被拉伸**

</tab>
<tab title="性能" group-key="performance">

快速渲染
: 这有时会以不可预知的方式破坏光影包。
> 如果你有这方面的问题，请将其设置为 `关` 。

</tab>
<tab title="光影" group-key="shader">

抗锯齿
: 如果光影提供了抗锯齿效果，或者观感上方块边缘已经没有锯齿，则将其设置为 `关` 。
> 内置抗锯齿使用的是 FXAA，其效果非常有限，而且可能导致实体名称等对象出现渲染问题。

法线贴图／高光贴图
: 禁用它们可能会让光影产生未知错误，将其设置为 `开` 。

渲染精细度
: 这可能会破坏使用自定义缓冲区大小的光影。最好将其设置为 `1x`。

阴影精细度
: 这可能会破坏在阴影纹理上进行几何处理的光影，特别是各种光线追踪光影。最好是将其设置为 `1x`。

经典光效
: 经典光效会强制在各种表面上应用原版光照和环境光遮蔽，光影通常会提供更好的光照效果，通常也会在配置中禁用该选项。  
> - 如果设置为 `默认` ，在切换各种光影时可能会由于不同光影对该选项的设置不同导致**资源包被不断重载**。
> - 如果你不使用 `（内置）` 光影进行游玩（便于使用高渲染精度和内置 FXAA 抗锯齿），可以直接将其设置为 `关` 。
> - 如果你需要游玩原版，可以直接将光影切换至 `关闭` ，并将 `图像品质` 切换为 *`极佳！`*

</tab>
</tabs>
<tabs group="videoSettings">
<tab title="品质" group-key="quality"></tab>
<tab title="细节" group-key="detail"></tab>
<tab title="性能" group-key="performance"></tab>
<tab title="光影" group-key="shader"></tab>
</tabs>